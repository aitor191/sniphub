<div class="snippets-container">
    <header class="snippets-header">
      <div class="header-left">
        <a routerLink="/dashboard" class="btn btn-secondary">â† Volver al Dashboard</a>
        <h1>Mis Snippets</h1>
      </div>
      <a routerLink="/snippets/new" class="btn btn-primary">
        â• Nuevo Snippet
      </a>
    </header>
  
    <!-- Filtros y bÃºsqueda -->
    <div class="filters-section">
      <div class="search-box">
        <div class="search-input-wrapper">
          <input 
            type="text" 
            [(ngModel)]="searchQuery"
            (keyup.enter)="onSearch()"
            (focus)="onSearchFocus()"
            (blur)="onSearchBlur()"
            placeholder="Buscar por tÃ­tulo o descripciÃ³n..."
            class="search-input"
          />
          <!-- Historial de bÃºsquedas -->
          <div class="search-history" *ngIf="showHistory && searchHistory.length > 0">
            <div class="history-header">
              <span>BÃºsquedas recientes</span>
              <button 
                type="button"
                (click)="clearHistory()"
                class="btn-clear-history"
                title="Limpiar historial"
              >
                ğŸ—‘ï¸ Limpiar
              </button>
            </div>
            <div class="history-items">
              <div 
                *ngFor="let item of searchHistory" 
                class="history-item"
                (click)="selectHistoryItem(item)"
              >
                <span class="history-query">ğŸ” {{ item.query }}</span>
                <button 
                  type="button"
                  (click)="removeHistoryItem($event, item)"
                  class="btn-remove-item"
                  title="Eliminar"
                >
                  âœ•
                </button>
              </div>
            </div>
          </div>
        </div>
        <button (click)="onSearch()" class="btn btn-secondary">ğŸ” Buscar</button>
      </div>
  
      <div class="filters">
        <select 
          [(ngModel)]="selectedLanguage" 
          (change)="onFilterChange()"
          class="filter-select"
        >
          <option value="">Todos los lenguajes</option>
          <option *ngFor="let lang of languages" [value]="lang">{{ lang }}</option>
        </select>
  
        <label class="checkbox-label">
          <input 
            type="checkbox" 
            [(ngModel)]="showFavoritesOnly"
            (change)="onFilterChange()"
          />
          Solo favoritos â­
        </label>
      </div>
    </div>
  
    <!-- Mensaje de error -->
    <div class="error-message" *ngIf="errorMessage">
      {{ errorMessage }}
    </div>
  
    <!-- Estado de carga -->
    <div class="loading" *ngIf="isLoading">
      <p>Cargando snippets...</p>
    </div>
  
    <!-- Lista de snippets -->
    <div class="snippets-grid" *ngIf="!isLoading && snippets.length > 0">
      <div class="snippet-card" *ngFor="let snippet of snippets">
        <div class="snippet-header">
          <h3>
            <a [routerLink]="['/snippets', snippet.id]">{{ snippet.title }}</a>
          </h3>
          <div class="snippet-actions">
            <button 
              (click)="toggleFavorite(snippet)"
              [class.favorite]="snippet.is_favorite"
              class="btn-icon"
              title="Marcar como favorito"
            >
              {{ snippet.is_favorite ? 'â­' : 'â˜†' }}
            </button>
            <a 
              [routerLink]="['/snippets', 'edit', snippet.id]"
              class="btn-icon"
              title="Editar"
            >
              âœï¸
            </a>
            <button 
              (click)="deleteSnippet(snippet)"
              class="btn-icon btn-danger"
              title="Eliminar"
            >
              ğŸ—‘ï¸
            </button>
          </div>
        </div>
  
        <p class="snippet-description" *ngIf="snippet.description">
          {{ snippet.description }}
        </p>
  
        <div class="snippet-meta">
          <span class="badge badge-language">{{ snippet.language }}</span>
          <span class="badge badge-public" *ngIf="snippet.is_public">ğŸŒ PÃºblico</span>
          <span class="snippet-date">
            {{ snippet.updated_at | date:'short' }}
          </span>
        </div>
  
        <div class="snippet-code-preview">
          <pre><code>{{ snippet.code.substring(0, 150) }}{{ snippet.code.length > 150 ? '...' : '' }}</code></pre>
        </div>
      </div>
    </div>
  
    <!-- Mensaje cuando no hay snippets -->
    <div class="empty-state" *ngIf="!isLoading && snippets.length === 0">
      <p>No tienes snippets aÃºn.</p>
      <a routerLink="/snippets/new" class="btn btn-primary">
        Crear tu primer snippet
      </a>
    </div>
  
    <!-- PaginaciÃ³n -->
    <div class="pagination" *ngIf="!isLoading && totalPages > 1">
      <button 
        (click)="onPageChange(currentPage - 1)"
        [disabled]="currentPage === 1"
        class="btn btn-secondary"
      >
        â† Anterior
      </button>
      
      <div class="page-numbers">
        <button 
          *ngFor="let page of pages"
          (click)="onPageChange(page)"
          [class.active]="page === currentPage"
          class="btn-page"
        >
          {{ page }}
        </button>
      </div>
      
      <button 
        (click)="onPageChange(currentPage + 1)"
        [disabled]="!hasNext"
        class="btn btn-secondary"
      >
        Siguiente â†’
      </button>
    </div>
  
    <div class="pagination-info" *ngIf="!isLoading && total > 0">
      Mostrando {{ showingRange }}
    </div>
  </div>