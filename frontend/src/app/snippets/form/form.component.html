<div class="form-container">
    <header class="form-header">
      <h1>{{ isEditMode ? 'Editar Snippet' : 'Nuevo Snippet' }}</h1>
      <a routerLink="/snippets" class="btn btn-secondary">‚Üê Volver</a>
    </header>
  
    <!-- Mensajes -->
    <div class="success-message" *ngIf="successMessage">
      {{ successMessage }}
    </div>
  
    <div class="error-message" *ngIf="errorMessage">
      {{ errorMessage }}
    </div>
  
    <!-- Estado de carga -->
    <div class="loading" *ngIf="isLoading && !snippetForm.value.title">
      <p>Cargando...</p>
    </div>
  
    <!-- Formulario -->
    <form [formGroup]="snippetForm" (ngSubmit)="onSubmit()" *ngIf="!isLoading || snippetForm.value.title">
      <div class="form-grid">
        <!-- T√≠tulo -->
        <div class="form-group full-width">
          <label for="title">T√≠tulo *</label>
          <input 
            type="text" 
            id="title"
            formControlName="title"
            class="form-control"
            [class.invalid]="title?.invalid && title?.touched"
            placeholder="Ej: Funci√≥n para validar email"
          />
          <div class="error-text" *ngIf="title?.invalid && title?.touched">
            <span *ngIf="title?.errors?.['required']">El t√≠tulo es obligatorio</span>
            <span *ngIf="title?.errors?.['maxlength']">El t√≠tulo no puede tener m√°s de 200 caracteres</span>
          </div>
          <div class="char-count">{{ title?.value?.length || 0 }}/200</div>
        </div>
  
        <!-- Lenguaje -->
        <div class="form-group">
          <label for="language">Lenguaje *</label>
          <select 
            id="language"
            formControlName="language"
            class="form-control"
            [class.invalid]="language?.invalid && language?.touched"
          >
            <option value="">Selecciona un lenguaje</option>
            <option *ngFor="let lang of languages" [value]="lang">{{ lang }}</option>
          </select>
          <div class="error-text" *ngIf="language?.invalid && language?.touched">
            El lenguaje es obligatorio
          </div>
        </div>
  
        <!-- Categor√≠a (opcional por ahora) -->
        <div class="form-group">
          <label for="category_id">Categor√≠a</label>
          <input 
            type="number" 
            id="category_id"
            formControlName="category_id"
            class="form-control"
            placeholder="ID de categor√≠a (opcional)"
          />
        </div>
  
        <!-- Descripci√≥n -->
        <div class="form-group full-width">
          <label for="description">Descripci√≥n</label>
          <textarea 
            id="description"
            formControlName="description"
            class="form-control"
            rows="3"
            placeholder="Describe qu√© hace este snippet..."
          ></textarea>
        </div>
  
        <!-- C√≥digo -->
        <div class="form-group full-width">
          <label for="code">C√≥digo *</label>
          <textarea 
            id="code"
            formControlName="code"
            class="form-control code-textarea"
            rows="15"
            [class.invalid]="code?.invalid && code?.touched"
            placeholder="Pega aqu√≠ tu c√≥digo..."
          ></textarea>
          <div class="error-text" *ngIf="code?.invalid && code?.touched">
            El c√≥digo es obligatorio
          </div>
          <div class="char-count">{{ code?.value?.length || 0 }} caracteres</div>
        </div>
  
        <!-- Tags -->
        <div class="form-group full-width">
          <label for="tags">Tags</label>
          <input 
            type="text" 
            id="tags"
            formControlName="tags"
            class="form-control"
            placeholder="Ej: validaci√≥n, email, regex (separados por comas)"
          />
          <small class="form-hint">Separa los tags con comas</small>
        </div>
  
        <!-- Opciones -->
        <div class="form-group full-width">
          <div class="checkbox-group">
            <label class="checkbox-label">
              <input 
                type="checkbox" 
                formControlName="is_public"
              />
              <span>üåê Hacer p√∫blico</span>
              <small>Otros usuarios podr√°n ver este snippet</small>
            </label>
  
            <label class="checkbox-label">
              <input 
                type="checkbox" 
                formControlName="is_favorite"
              />
              <span>‚≠ê Marcar como favorito</span>
              <small>F√°cil acceso desde tus favoritos</small>
            </label>
          </div>
        </div>
      </div>
  
      <!-- Botones de acci√≥n -->
      <div class="form-actions">
        <button 
          type="button" 
          routerLink="/snippets"
          class="btn btn-secondary"
          [disabled]="isLoading"
        >
          Cancelar
        </button>
        <button 
          type="submit" 
          class="btn btn-primary"
          [disabled]="isLoading || snippetForm.invalid"
        >
          {{ isLoading ? 'Guardando...' : (isEditMode ? 'Actualizar' : 'Crear') }}
        </button>
      </div>
    </form>
  </div>