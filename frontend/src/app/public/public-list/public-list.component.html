<div class="snippets-container">
    <header class="snippets-header">
      <div class="header-left">
        <a routerLink="/dashboard" class="btn btn-secondary">â† Volver al Dashboard</a>
        <h1>ğŸŒ Snippets PÃºblicos</h1>
      </div>
      <div class="header-right">
      </div>
    </header>
  
    <!-- Filtros y bÃºsqueda -->
    <div class="filters-section">
      <div class="search-box">
        <div class="search-input-wrapper">
          <input 
            type="text" 
            [(ngModel)]="searchQuery"
            (input)="onSearchInput($any($event.target).value)"
            (keyup.enter)="onSearch()"
            (focus)="onSearchFocus()"
            (blur)="onSearchBlur()"
            placeholder="Buscar por tÃ­tulo o descripciÃ³n..."
            class="search-input"
          />
          <!-- Historial de bÃºsquedas -->
          <div class="search-history" *ngIf="showHistory && searchHistory.length > 0">
            <div class="history-header">
              <span>BÃºsquedas recientes</span>
              <button 
                type="button"
                (click)="clearHistory()"
                class="btn-clear-history"
                title="Limpiar historial"
                aria-label="Limpiar historial de bÃºsquedas"
              >
                ğŸ—‘ï¸ Limpiar
              </button>
            </div>
            <div class="history-items">
              <div 
                *ngFor="let item of searchHistory" 
                class="history-item"
                (click)="selectHistoryItem(item)"
              >
                <span class="history-query">ğŸ” {{ item.query }}</span>
                <button 
                  type="button"
                  (click)="removeHistoryItem($event, item)"
                  class="btn-remove-item"
                  title="Eliminar"
                  aria-label="Eliminar bÃºsqueda del historial"
                >
                  âœ•
                </button>
              </div>
            </div>
          </div>
        </div>
        <button (click)="onSearch()" class="btn btn-secondary">ğŸ” Buscar</button>
      </div>
  
      <div class="filters">
        <select 
          [(ngModel)]="selectedLanguage" 
          (change)="onFilterChange()"
          class="filter-select"
        >
          <option value="">Todos los lenguajes</option>
          <option *ngFor="let lang of languages" [value]="lang">{{ lang }}</option>
        </select>
      </div>
    </div>
  
    <!-- Mensaje de error -->
    <div class="error-message" *ngIf="errorMessage">
      {{ errorMessage }}
    </div>
  
    <!-- Estado de carga -->
    <div class="loading" *ngIf="isLoading">
      <p>Cargando snippets pÃºblicos...</p>
    </div>
  
    <!-- Lista de snippets -->
    <div class="snippets-grid" *ngIf="!isLoading && snippets.length > 0">
      <div class="snippet-card" *ngFor="let snippet of snippets" [routerLink]="['/public', snippet.id]">
        <div class="snippet-header">
          <h3>{{ snippet.title }}</h3>
          <div class="snippet-badges">
            <span class="badge badge-language">{{ snippet.language }}</span>
          </div>
          <div class="snippet-actions">
            <button 
              (click)="$event.stopPropagation(); copyCode(snippet)"
                class="btn-icon"
                [class.copied]="copiedId === snippet.id"
                [title]="copiedId === snippet.id ? 'Copiado' : 'Copiar cÃ³digo'"
                [attr.aria-label]="copiedId === snippet.id ? 'Copiado' : 'Copiar cÃ³digo'"
            >
                {{ copiedId === snippet.id ? 'âœ“' : 'ğŸ“‹' }}
            </button>
          </div>
        </div>
  
        <p class="snippet-description" *ngIf="snippet.description">
          {{ snippet.description }}
        </p>
  
        <div class="snippet-meta">
          <span class="snippet-date">
            {{ snippet.updated_at | date:'short' }}
          </span>
        </div>
  
        <div class="snippet-code-preview">
          <pre><code>{{ snippet.code.substring(0, 150) }}{{ snippet.code.length > 150 ? '...' : '' }}</code></pre>
        </div>
      </div>
    </div>
  
    <!-- Mensaje cuando no hay snippets -->
    <div class="empty-state" *ngIf="!isLoading && snippets.length === 0">
      <p>No hay snippets pÃºblicos disponibles.</p>
    </div>
  
    <!-- PaginaciÃ³n -->
    <div class="pagination" *ngIf="!isLoading && totalPages > 1">
      <button 
        (click)="onPageChange(currentPage - 1)"
        [disabled]="currentPage === 1"
        class="btn btn-secondary"
      >
        â† Anterior
      </button>
      
      <div class="page-numbers">
        <button 
          *ngFor="let page of pages"
          (click)="onPageChange(page)"
          [class.active]="page === currentPage"
          class="btn-page"
        >
          {{ page }}
        </button>
      </div>
      
      <button 
        (click)="onPageChange(currentPage + 1)"
        [disabled]="!hasNext"
        class="btn btn-secondary"
      >
        Siguiente â†’
      </button>
    </div>
  
    <div class="pagination-info" *ngIf="!isLoading && total > 0">
      Mostrando {{ showingRange }}
    </div>
  </div>